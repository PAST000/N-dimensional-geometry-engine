<!DOCTYPE html>
<html>
<head>
    <title>3D engine test</title>
    <style>
        body, html{
            margin: 0;
        }

        canvas{
            width: 1000px;
            height: 800px;
            display: block;
            border: 1px solid black;
            margin: 10px;
        }
    </style>
    <script type="module">
        import Engine from "./Engine.js";
        import Color from "./Objects/base/Color.js";
        import HyperVertex from "./Objects/base/HyperVertex.js";
        import HyperCube from "./Objects/HyperCube.js";
        import HyperCuboid from "./Objects/HyperCuboid.js";
        import CubicFrame from "./Objects/CubicFrame.js";
        import Arrow from "./Objects/Arrow.js";
        import Binomial from "./binomialTheorem.js";

        window.onload = function() {
            const canvas = document.getElementById("cnv");
            if (!canvas) {
                console.error("Canvas not found!");
                return;
            }

            const engine = new Engine(canvas, 5, 1.1, 6);
            const binomial = new Binomial(new HyperVertex([0,0,0,0]), 4, 150, 50, 
                                         [new Color(255, 0, 0, 0.2), new Color(0, 200, 0, 0.2), new Color(0,0, 200, 0.2), new Color(255, 255, 0, 0.2), new Color(0, 255, 255, 0.2)], 
                                         null, 
                                         [0,0,0,0,0,0]);
            engine.addObjects(binomial.getObjects());
            engine.draw();

            const deg = 5, interval = 60;
            let intervalId = null;
            function rotateAll(ax1, ax2, dir){
                if (intervalId === null) return;
                engine.rotateAll(ax1, ax2, dir*deg*Math.PI/360);
            }
            function stopFunction() {
                if (intervalId !== null) {
                    clearInterval(intervalId);
                    intervalId = null;
                }
            }

            document.getElementById("X;Y").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(0,1,1), interval); });
            document.getElementById("X;Z").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(0,2,1), interval); });
            document.getElementById("X;W").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(0,3,1), interval); });
            document.getElementById("Y;Z").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(1,2,1), interval); });
            document.getElementById("Y;W").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(1,3,1), interval); });
            document.getElementById("Z;W").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(2,3,1), interval); });

            document.getElementById("-X;Y").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(0,1,-1), interval); });
            document.getElementById("-X;Z").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(0,2,-1), interval); });
            document.getElementById("-X;W").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(0,3,-1), interval); });
            document.getElementById("-Y;Z").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(1,2,-1), interval); });
            document.getElementById("-Y;W").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(1,3,-1), interval); });
            document.getElementById("-Z;W").addEventListener('mousedown', () => { intervalId = setInterval(() => rotateAll(2,3,-1), interval); });

            document.addEventListener('mouseup', stopFunction);
            document.addEventListener('mouseleave', stopFunction);
        };
        
    </script>
</head>
<body>
    <section>
        <canvas id="cnv"></canvas>
        <button id="X;Y">&nbsp;X;Y</button>
        <button id="X;Z">&nbsp;X;Z</button>
        <button id="X;W">&nbsp;X;W</button>
        <button id="Y;Z">&nbsp;Y;Z</button>
        <button id="Y;W">&nbsp;Y;W</button>
        <button id="Z;W">&nbsp;Z;W</button><br>
        <button id="-X;Y">-X;Y</button>
        <button id="-X;Z">-X;Z</button>
        <button id="-X;W">-X;W</button>
        <button id="-Y;Z">-Y;Z</button>
        <button id="-Y;W">-Y;W</button>
        <button id="-Z;W">-Z;W</button><br>
        <button id="camera-X">-X</button>
        <button id="camera+X">+X</button>
        <button id="camera-Y">-Y</button>
        <button id="camera+Y">+Y</button>
        <button id="camera-Z">-Z</button>
        <button id="camera+Z">+Z</button>
    </section>
</body>
</html>